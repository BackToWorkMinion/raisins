@model IEnumerable<Raisins.Client.Web.Models.Payment>

@{
    ViewBag.Title = "Index";
}

<ul>
    <li>@Html.ActionLink("Create New", "Create")</li>
    <li>@Html.ActionLink("Lock all", "LockAll")</li>
    <li>@Html.ActionLink("Lock Local", "LockLocal")</li>
    <li>@Html.ActionLink("Lock International", "LockInternational")</li>
</ul>
<table id="payment-grid">
    <thead>
        <tr>
            <th class="controls"></th>
            <th class="beneficiary">Band Voted</th>
            <th class="name">Name</th>
            <th class="currency">Currency</th>
            <th class="amount">Actual Amount</th>
            <th class="votes">Votes</th>
            <th class="total">Converted Amount</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var payment in Model)
        { 
            <tr>
                <td class="controls">
                    <ul>
                        @if(!payment.Locked)
                        {
                        <li>@Html.ActionLink("Edit", "Edit", new { ID = payment.ID }) </li>
                        <li>@Html.ActionLink("Delete", "Delete", new { ID = payment.ID })</li>
                        }
                        else
                        {
                        <li>@Html.ActionLink("Email", "Email", new { ID = payment.ID })</li>
                        }
                    </ul>
                </td>
                <td class="beneficiary">@Html.DisplayFor(model => payment.Beneficiary.Name)</td>
                <td class="name">@Html.DisplayFor(model => payment.Name)</td>
                <td class="currency">@Html.DisplayFor(model => payment.Currency.CurrencyCode)</td>
                <td class="amount">@Html.DisplayFor(model => payment.Amount)</td>
                <td class="votes">@(Math.Floor(payment.Amount / payment.Currency.Ratio))</td>
                <td class="total">@((payment.Amount * payment.Currency.ExchangeRate).ToString("0.00"))
                </td>
            </tr>
        }
    </tbody>
</table>
